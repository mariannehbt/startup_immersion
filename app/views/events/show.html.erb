<p id="notice"><%= notice %></p>

<p>
  <strong>Startup:</strong>
  <%= @event.startup.name %>
  <%= link_to 'Startup', startup_path(@event.startup.id) %>
  <%= link_to @event.startup.name, startup_path(@event.startup.id) %>
</p>

<p>
  <strong>Title:</strong>
  <%= @event.title %>
</p>

<p>
  <strong>Start datetime:</strong>
  <%= @event.start_datetime %>
</p>

<p>
  <strong>Duration:</strong>
  <%= @event.duration %>
</p>

<p>
  <strong>End date:</strong>
  <%= @event.end_date %>
</p>

<p>
  <strong>Description:</strong>
  <%= @event.description %>
</p>

<p>
  <strong>Short location:</strong>
  <%= @event.short_location %>
</p>

<% if current_user && current_user.admin? %>
  
  <p>
    <strong>Adress:</strong>
    <%= @event.adress %>
  </p>

  <p>
    <strong>Zip code:</strong>
    <%= @event.zip_code %>
  </p>

  <p>
    <strong>City:</strong>
    <%= @event.city %>
  </p>

  <h2>Registration for this event :</h2>
  <p><%= @event.attendances.count %> registrations</p>
  <%= link_to "See all &raquo;".html_safe, admin_event_attendances_path(@event), :class =>'btn btn-primary' %>

  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Attendance</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% for attendance in @event.attendances %>
        <tr>
          <td><%= link_to "#{attendance.user.email} &raquo;".html_safe, user_path(attendance.user), :class =>'btn btn-primary' %></td>
          <td><%= link_to "Details &raquo;".html_safe, event_attendance_path(@event, attendance), :class =>'btn btn-primary' %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if current_user && current_user.admin? %>
  <%= link_to 'Edit', edit_admin_event_path(@event) %> |
  <%= link_to 'Ajouter une pré-inscription', new_event_attendance_path(@event) %> |
  <%= link_to 'Destroy', @event, method: :delete, data: { confirm: 'Are you sure?' } %> |
<% elsif @event.users.include?(current_user) %>
  <% att = Attendance.find_by(user_id: current_user, event_id: @event) %>
    <%if att.reviewed? && att.validated? %>
      <%= link_to 'Mon inscription', user_path(current_user) %> |
    <%elsif att.reviewed? && att.validated? == false %>
      <%= link_to 'Ma pré-inscription', user_path(current_user) %> |
    <% else %>
      <%= link_to 'Déjà pré-inscrit(e)', user_path(current_user) %> |
    <% end %>
<% else %>
  <%= link_to 'Se pré-inscrire', new_event_attendance_path(@event) %> |
<% end %>
<%= link_to 'Back', :events %>
